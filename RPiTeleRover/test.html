<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="EXPIRES" content="0">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="viewport" content = "height = device-height, width = 420, user-scalable = no" /> 
        <title>WebIOPi | Demo</title>
        <script type="text/javascript" src="/webiopi.js"></script>
        <script type="text/javascript">

        webiopi().ready(function() {

                var left, right, top, button;

		top = $( "#topbuttons" );
		left = $( "#leftbuttons" );
		right = $( "#rightbuttons" );
                        
		webiopi().setFunction(11, "OUT"); // mode
		webiopi().setValue(11, 0);	  // IN-IN mode

		webiopi().setFunction(9, "PWM");  // a phase
		webiopi().setFunction(10, "PWM"); // a enable
		webiopi().setFunction(21, "PWM"); // b phase
		webiopi().setFunction(22, "PWM"); // b enable

                //button = webiopi().createGPIOButton(9, "A Phase");
                //left.append(button); // append button to content div

		//button = webiopi().createButton(10, "A Enable");
                //left.append(button); // append button to content div

                //button = webiopi().createGPIOButton(21, "B Phase");
                //right.append(button); // append button to content div

                //button = webiopi().createButton(22, "B Enable");
                //right.append(button); // append button to content div

                //button = webiopi().createGPIOButton(11, "Mode");
                //top.append(button); // append button to content div

		$("#F").mousedown(fwd);
		$("#F").mouseup(stop);

		$("#FL").mousedown(fwdLeft);
		$("#FL").mouseup(stop);

		$("#FR").mousedown(fwdRight);
		$("#FR").mouseup(stop);

		$("#R").mousedown(rev);
		$("#R").mouseup(stop);

		$("#RL").mousedown(revLeft);
		$("#RL").mouseup(stop);

		$("#RR").mousedown(revRight);
		$("#RR").mouseup(stop);

		$("#SR").mousedown(spinRight);
		$("#SR").mouseup(stop);

		$("#SL").mousedown(spinLeft);
		$("#SL").mouseup(stop);

		//$("#ST").mousedown(stop);
		//$("#ST").mouseup(stop);

		//$("#joystick").mouseup(function(e) {
		//	$("#joystick").unbind('mousemove');
		//	$('#status2').html('0, 0');
		//	setSpeed(0,0);
		//});
	});

	function sign(x) {
		return x / Math.abs(x);
	}


	function fwd() {
                webiopi().setValue(11, 0);
                webiopi().pulseRatio(9, 0);     // AIN1
                webiopi().pulseRatio(10, 0.7);  // AIN2
                webiopi().pulseRatio(21, 0);    // BIN1
                webiopi().pulseRatio(22, 0.5);  // BIN2
	}

	function fwdLeft() {
                webiopi().setValue(11, 0);
                webiopi().pulseRatio(9, 1.0);	// AIN1
                webiopi().pulseRatio(10, 1.0);	// AIN2
                webiopi().pulseRatio(21, 0);	// BIN1
                webiopi().pulseRatio(22, 1.0);	// BIN2
	}

	function fwdRight() {
                webiopi().setValue(11, 0);
                webiopi().pulseRatio(9, 0);	// AIN1
                webiopi().pulseRatio(10, 1.0);	// AIN2
                webiopi().pulseRatio(21, 1.0);	// BIN1
                webiopi().pulseRatio(22, 1.0);	// BIN2
	}

	function rev() {
                webiopi().setValue(11, 0);
                webiopi().pulseRatio(9, 0.6);	// AIN1
                webiopi().pulseRatio(10, 0);	// AIN2
                webiopi().pulseRatio(21, 0.6);	// BIN1
                webiopi().pulseRatio(22, 0);	// BIN2
	}

	function revRight() {
                webiopi().setValue(11, 0);
                webiopi().pulseRatio(9, 1.0);	// AIN1
                webiopi().pulseRatio(10, 1.0);	// AIN2
                webiopi().pulseRatio(21, 0.6);	// BIN1
                webiopi().pulseRatio(22, 0);	// BIN2
	}

	function revLeft() {
                webiopi().setValue(11, 0);
                webiopi().pulseRatio(9, 0.6);	// AIN1
                webiopi().pulseRatio(10, 0);	// AIN2
                webiopi().pulseRatio(21, 1.0);	// BIN1
                webiopi().pulseRatio(22, 1.0);	// BIN2
	}

	function spinLeft() {
                webiopi().setValue(11, 0);
                webiopi().pulseRatio(9, 0.6);	// AIN1
                webiopi().pulseRatio(10, 0);	// AIN2
                webiopi().pulseRatio(21, 0);	// BIN1
                webiopi().pulseRatio(22, 0.6);	// BIN2
	}

	function spinRight() {
		webiopi().setValue(11, 0);
		webiopi().pulseRatio(9, 0.0);	// AIN2
		webiopi().pulseRatio(10, 0.6);	// AIN2
		webiopi().pulseRatio(21, 0.6);	// BIN2
		webiopi().pulseRatio(22, 0);	// BIN2
	}

	function stop() {
                webiopi().setValue(11, 0);
                webiopi().pulseRatio(9, 1.0);	// AIN1
                webiopi().pulseRatio(10, 1.0);	// AIN2
                webiopi().pulseRatio(21, 1.0);	// BIN1
                webiopi().pulseRatio(22, 1.0);	// BIN2
	}

        </script>
        <style type="text/css">

		#streamimage {
			width:520px; height: 390px;
		}

                button {
                        display: block;
                        margin: 5px 5px 5px 5px;
                        width: 100px;
                        height: 40px;
                        font-size: 10pt;
                        font-weight: bold;
                        color: black;
                }
                
                .LOW {
                        background-color: White;
                }
                
                .HIGH { 
                        background-color: Red;
                }
        </style>
</head>
<body>
	<div align="center">
	<table>
		<tr>
			<td></td>
			<td align="center" id="topbuttons"></td></tr>
			<td></td>
		<tr>
			<td id="leftbuttons"></td>
			<td align="center"><img id="streamimage" src="http://192.168.0.4:8080/?action=stream"/></td>
			<td id="rightbuttons"></td>
		</tr>
	</table>

	<table padding=5>
		<tr height="80" align="center">
			<td id="FL" width="80" bgcolor="grey">FL</td>
			<td id="F"  width="80" bgcolor="grey">F</td>
			<td id="FR" width="80" bgcolor="grey">FR</td>
		</tr>
		<tr height="80" align="center">
			<td id="SL" width="80" bgcolor="grey">SL</td>
			<td id="ST" width="80" bgcolor="grey">ST</td>
			<td id="SR" width="80" bgcolor="grey">SR</td>
		</tr>
		<tr height="80" align="center">
			<td id="RL" width="80" bgcolor="grey">RL</td>
			<td id="R"  width="80" bgcolor="grey">R</td>
			<td id="RR" width="80" bgcolor="grey">RR</td>
		</tr>
	</table>
	</div>
	<div id="status2" align="center"></div>
</body>
</html>
